# sfdv

## GCF
[![serverless](http://public.serverless.com/badges/v3.svg)](http://www.serverless.com)

This should enable developer to write reusable pipelines/functions.
The usecase in focus for this repo is for developing RESTful API.

References : 
1. https://serverless.com/
2. GCP : https://serverless.com/framework/docs/providers/google/guide/quick-start/
3. AWS : https://serverless.com/framework/docs/providers/aws/guide/quick-start/
4. https://github.com/serverless/examples/tree/master/google-node-simple-http-endpoint

***
### Using the SLS on GCP

* Install the SLS framework 
* For Google Cloud function use the following substeps.
 * `sls create --template google-python --path kbapi-someFunctionalityName`
 * Navigate the the created folder > cd kbapi-someFunctionalityName
 * Edit the `serverless.yml` as below
```yml
service: kbapi-someFunctionalityName

provider:
  name: google
  stage: dev
  runtime: python37
  region: us-central1
  project: <your-cloud-project-id>
  credentials: ~/.gcloud/keyfile.json  ## This should be created in the first step of sls setup

plugins:
  - serverless-google-cloudfunctions

package:
  exclude:
    - node_modules/**
    - .gitignore
    - .git/**

functions:
  first:
    handler: main  ## This is the GCF entry function that will be called when the GCF is invoked
    events:
      - http: path
  # NOTE: the following uses an "event" event (pubSub event in this case).
  # Please create the corresponding resources in the Google Cloud
  # before deploying this service through Serverless
  #second:
  #  handler: event
  #  events:
  #    - event:
  #        eventType: providers/cloud.pubsub/eventTypes/topic.publish
  #        resource: projects/*/topics/my-topic
```


 * run the following command `npm install` to install dependencies and whatnots.
 * Go nuts and code the function out and deploy it using `sls deploy`
   Note: maintain `requirements.txt` using either pipenv or manually

***
### Using the Gcloud on Python

In case you are using Google cloud's native method to deploy a function in that scenario follow the steps below

1. Code should folow the structure with 2 files.
   * main.py
   * requirements.txt
2. Test each and every corner of what you've written unless basking in the glory of being precariousness if your thing.
3. Deploy using the below command 
```
gcloud functions deploy 
--source <your-source-repo-link> 
--entry-point main 
--runtime python37 
--trigger-http 
--memory=2GB 
--timeout=540s 
--project <your-cloud-project-id>
```
